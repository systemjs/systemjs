{"version":3,"file":"named-register.min.js","sources":["../../src/extras/named-register.js"],"sourcesContent":["/*\n * SystemJS named register extension\n * Supports System.register('name', [..deps..], function (_export, _context) { ... })\n * \n * Names are written to the registry as-is\n * System.register('x', ...) can be imported as System.import('x')\n */\n(function (global) {\n  var System = global.System;\n  setRegisterRegistry(System);\n  var systemJSPrototype = System.constructor.prototype;\n  var constructor = System.constructor;\n  var SystemJS = function () {\n    constructor.call(this);\n    setRegisterRegistry(this);\n  };\n  SystemJS.prototype = systemJSPrototype;\n  System.constructor = SystemJS;\n\n  var firstNamedDefine;\n\n  function setRegisterRegistry(systemInstance) {\n    systemInstance.registerRegistry = Object.create(null);\n  }\n\n  var register = systemJSPrototype.register;\n  systemJSPrototype.register = function (name, deps, declare) {\n    if (typeof name !== 'string')\n      return register.apply(this, arguments);\n    var define = [deps, declare];\n    this.registerRegistry[name] = define;\n    if (!firstNamedDefine) {\n      firstNamedDefine = define;\n      Promise.resolve().then(function () {\n        firstNamedDefine = null;\n      });\n    }\n    return register.apply(this, arguments);\n  };\n\n  var resolve = systemJSPrototype.resolve;\n  systemJSPrototype.resolve = function (id, parentURL) {\n    try {\n      // Prefer import map (or other existing) resolution over the registerRegistry\n      return resolve.call(this, id, parentURL);\n    } catch (err) {\n      if (id in this.registerRegistry) {\n        return id;\n      }\n      throw err;\n    }\n  };\n\n  var instantiate = systemJSPrototype.instantiate;\n  systemJSPrototype.instantiate = function (url, firstParentUrl) {\n    var result = this.registerRegistry[url];\n    if (result) {\n      this.registerRegistry[url] = null;\n      return result;\n    } else {\n      return instantiate.call(this, url, firstParentUrl);\n    }\n  };\n\n  var getRegister = systemJSPrototype.getRegister;\n  systemJSPrototype.getRegister = function () {\n    // Calling getRegister() because other extras need to know it was called so they can perform side effects\n    var register = getRegister.call(this);\n\n    var result = firstNamedDefine || register;\n    firstNamedDefine = null;\n    return result;\n  }\n})(typeof self !== 'undefined' ? self : global);\n"],"names":["global","setRegisterRegistry","systemInstance","registerRegistry","Object","create","System","firstNamedDefine","systemJSPrototype","constructor","prototype","SystemJS","call","this","register","name","deps","declare","apply","arguments","define","Promise","resolve","then","id","parentURL","err","instantiate","url","firstParentUrl","result","getRegister","self"],"mappings":"CAOA,SAAWA,GAcT,SAASC,EAAoBC,GAC3BA,EAAeC,iBAAmBC,OAAOC,OAAO,MAdlD,IAAIC,EAASN,EAAOM,OACpBL,EAAoBK,GACpB,IASIC,EATAC,EAAoBF,EAAOG,YAAYC,UACvCD,EAAcH,EAAOG,YACrBE,EAAW,WACbF,EAAYG,KAAKC,MACjBZ,EAAoBY,OAEtBF,EAASD,UAAYF,EACrBF,EAAOG,YAAcE,EAQrB,IAAIG,EAAWN,EAAkBM,SACjCN,EAAkBM,SAAW,SAAUC,EAAMC,EAAMC,GACjD,GAAoB,iBAATF,EACT,OAAOD,EAASI,MAAML,KAAMM,WAC9B,IAAIC,EAAS,CAACJ,EAAMC,GAQpB,OAPAJ,KAAKV,iBAAiBY,GAAQK,EACzBb,IACHA,EAAmBa,EACnBC,QAAQC,UAAUC,MAAK,WACrBhB,EAAmB,SAGhBO,EAASI,MAAML,KAAMM,YAG9B,IAAIG,EAAUd,EAAkBc,QAChCd,EAAkBc,QAAU,SAAUE,EAAIC,GACxC,IAEE,OAAOH,EAAQV,KAAKC,KAAMW,EAAIC,GAC9B,MAAOC,GACP,GAAIF,KAAMX,KAAKV,iBACb,OAAOqB,EAET,MAAME,IAIV,IAAIC,EAAcnB,EAAkBmB,YACpCnB,EAAkBmB,YAAc,SAAUC,EAAKC,GAC7C,IAAIC,EAASjB,KAAKV,iBAAiByB,GACnC,OAAIE,GACFjB,KAAKV,iBAAiByB,GAAO,KACtBE,GAEAH,EAAYf,KAAKC,KAAMe,EAAKC,IAIvC,IAAIE,EAAcvB,EAAkBuB,YACpCvB,EAAkBuB,YAAc,WAE9B,IAAIjB,EAAWiB,EAAYnB,KAAKC,MAE5BiB,EAASvB,GAAoBO,EAEjC,OADAP,EAAmB,KACZuB,GAhEX,CAkEmB,oBAATE,KAAuBA,KAAOhC"}